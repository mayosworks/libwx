//=============================================================================
// Auxiliary library for Windows API (C++)
//                                                     Copyright (c) 2007 MAYO.
//=============================================================================
#pragma once

namespace wx {

//-----------------------------------------------------------------------------
//! @class	BinReader
//! @brief	バイナリファイル読み取り
//-----------------------------------------------------------------------------
class BinReader
{
public:
	//-------------------------------------------------------------------------
	//! @brief	コンストラクタ
	//-------------------------------------------------------------------------
	BinReader();

	//-------------------------------------------------------------------------
	//! @brief	デストラクタ
	//-------------------------------------------------------------------------
	~BinReader();

	//-------------------------------------------------------------------------
	//! @brief	ファイルを読み取り用に開く
	//!
	//! @param	path		ファイルパス
	//!
	//! @retval	true		開けた
	//! @retval	false		開けなかった
	//-------------------------------------------------------------------------
	bool Open(PCTSTR path);

	//-------------------------------------------------------------------------
	//! @brief	ファイルを閉じる
	//-------------------------------------------------------------------------
	void Close();

	//-------------------------------------------------------------------------
	//! @brief	ファイルから読み取る
	//!
	//! @param	buffer		読み取り先のバッファ [OUT]
	//! @param	size		読み取るバイト数
	//!
	//! @return	実際に読み取ったバイト数
	//-------------------------------------------------------------------------
	DWORD Read(void* buffer, DWORD size);

	//-------------------------------------------------------------------------
	//! @brief	ファイルポインタを設定する
	//!
	//! @param	new_pointer	新しいファイルポインタ
	//! @param	move_method	移動方法
	//!
	//! @return	移動後のファイルポインタ
	//-------------------------------------------------------------------------
	DWORD SetPointer(long new_pointer, DWORD move_method);

	//-------------------------------------------------------------------------
	//! @brief	ファイルサイズを取得する
	//!
	//! @return	ファイルサイズ
	//-------------------------------------------------------------------------
	DWORD GetSize() const;

	//-------------------------------------------------------------------------
	//! @brief	まだ読み取ってないサイズを取得する
	//!
	//! @return	まだ読み取っていないファイルのデータサイズ
	//-------------------------------------------------------------------------
	DWORD GetLeftSize() const;

private:
	// コピーコンストラクタ、代入演算子を無効化
	BinReader             (const BinReader&);
	BinReader& operator = (const BinReader&);

private:
	HANDLE m_file;
};

//-----------------------------------------------------------------------------
//! @class	BinWriter
//! @brief	バイナリファイル書き込み
//-----------------------------------------------------------------------------
class BinWriter
{
public:
	//-------------------------------------------------------------------------
	//! @brief	コンストラクタ
	//-------------------------------------------------------------------------
	BinWriter();

	//-------------------------------------------------------------------------
	//! @brief	デストラクタ
	//-------------------------------------------------------------------------
	~BinWriter();

	//-------------------------------------------------------------------------
	//! @brief	ファイルを書き込み用に開く
	//!
	//! @param	path		ファイルパス
	//!
	//! @retval	true		開けた
	//! @retval	false		開けなかった
	//-------------------------------------------------------------------------
	bool Open(PCTSTR file_path);

	//-------------------------------------------------------------------------
	//! @brief	ファイルを閉じる
	//-------------------------------------------------------------------------
	void Close();

	//-------------------------------------------------------------------------
	//! @brief	ファイルに書き込む
	//!
	//! @param	data		書き込むデータ
	//! @param	size		書き込むバイト数
	//!
	//! @return	実際に書き込んたバイト数
	//-------------------------------------------------------------------------
	DWORD Write(const void* data, DWORD size);

	//-------------------------------------------------------------------------
	//! @brief	ファイルポインタを設定する
	//!
	//! @param	new_pointer	新しいファイルポインタ
	//! @param	move_method	移動方法
	//!
	//! @return	移動後のファイルポインタ
	//-------------------------------------------------------------------------
	DWORD SetPointer(long new_pointer, DWORD move_method);

private:
	// コピーコンストラクタ、代入演算子を無効化
	BinWriter             (const BinWriter&);
	BinWriter& operator = (const BinWriter&);

private:
	HANDLE m_file;
};

} //namespace wx
