//=============================================================================
// Auxiliary library for Windows API (C++)
//                                                     Copyright (c) 2007 MAYO.
//=============================================================================
#pragma once

namespace wx {

//-----------------------------------------------------------------------------
//! @class	Console
//! @brief	コンソールウィンドウコントロール
//-----------------------------------------------------------------------------
class Console
{
public:
	//-------------------------------------------------------------------------
	//! @brief	デフォルトコンストラクタ
	//-------------------------------------------------------------------------
	Console();

	//-------------------------------------------------------------------------
	//! @brief	ハンドル指定コンストラクタ
	//!
	//! @param	console		コンソールハンドル
	//-------------------------------------------------------------------------
	explicit Console(HANDLE console);

	//-------------------------------------------------------------------------
	//! @brief	デストラクタ
	//-------------------------------------------------------------------------
	~Console();

	//-------------------------------------------------------------------------
	//! @brief	コンソールをクリアする（書き込みアクセスできる場合のみ）
	//-------------------------------------------------------------------------
	void Clear();

	//-------------------------------------------------------------------------
	//! @brief	カーソルを配置する
	//!
	//! @param	x			文字数単位でのＸ座標
	//! @param	y			文字数単位でのＹ座標
	//-------------------------------------------------------------------------
	void Locate(int x, int y);

	//-------------------------------------------------------------------------
	//! @brief	文字色を設定する
	//!
	//! @note	SetConsoleTextAttribute()APIの説明参照のこと
	//!
	//! @param	color		文字色インデックス
	//-------------------------------------------------------------------------
	void SetColor(WORD color);

	//-------------------------------------------------------------------------
	//! @brief	カーソルの表示を設定する
	//!
	//! @param	show		カーソルを表示するかどうか、true:表示、false:消す
	//-------------------------------------------------------------------------
	void ShowCursor(bool show);

	//-------------------------------------------------------------------------
	//! @brief	カーソルの表示状態を取得する
	//!
	//! @retval	true		カーソルを表示する
	//! @retval	false		カーソルを表示しない
	//-------------------------------------------------------------------------
	bool IsCursorVisible() const;

private:
	HANDLE	m_console;
	bool	m_visible;
};

} //namespace wx
